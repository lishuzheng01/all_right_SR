# SISSO计算库多种输入格式支持

SISSO计算库现已支持多种输入数据格式，包括numpy数组和pandas对象。这使得库的使用更加灵活和便利。

## 支持的输入格式

### 1. NumPy数组输入
```python
import numpy as np
from sisso_py.sparse_regression.sisso import SISSORegressor

# 1维数组会自动转换为2维
X = np.linspace(-2*np.pi, 2*np.pi, 100)  # 形状: (100,)
y = np.sin(X)  # 形状: (100,)

model = SISSORegressor(K=2, sis_screener='pearson', so_solver='omp')
model.fit(X, y, feature_names=['x'])  # 指定特征名称（可选）

# 预测
y_pred = model.predict(X)
```

### 2. Pandas对象输入
```python
import pandas as pd
from sisso_py.sparse_regression.sisso import SISSORegressor

# 使用DataFrame和Series
X = pd.DataFrame(np.linspace(-2*np.pi, 2*np.pi, 100).reshape(-1, 1), columns=['x'])
y = pd.Series(np.sin(X['x']), name='y')

model = SISSORegressor(K=2, sis_screener='pearson', so_solver='omp')
model.fit(X, y)  # 不需要指定特征名称

# 预测
y_pred = model.predict(X)
```

### 3. 混合输入格式
```python
# 训练时使用numpy数组
X_train = np.linspace(-2*np.pi, 2*np.pi, 100)
y_train = np.sin(X_train)

model = SISSORegressor(K=2)
model.fit(X_train, y_train, feature_names=['x'])

# 预测时使用pandas DataFrame
X_test = pd.DataFrame(np.linspace(-np.pi, np.pi, 50).reshape(-1, 1), columns=['x'])
y_pred = model.predict(X_test)
```

## 支持的算法

以下算法均支持多种输入格式：

### 1. SISSO回归器
```python
from sisso_py.sparse_regression.sisso import SISSORegressor

model = SISSORegressor(
    K=3,                      # 特征复杂度层级
    sis_screener='pearson',   # 特征筛选方法
    so_solver='omp'           # 稀疏求解器
)
```

### 2. Lasso回归器
```python
from sisso_py.sparse_regression.lasso_ridge_omp import LassoRegressor

model = LassoRegressor(
    poly_degree=2,            # 多项式特征次数
    normalize=True            # 是否标准化
)
```

### 3. Ridge回归器
```python
from sisso_py.sparse_regression.lasso_ridge_omp import RidgeRegressor

model = RidgeRegressor(
    poly_degree=2,
    normalize=True
)
```

### 4. OMP回归器
```python
from sisso_py.sparse_regression.lasso_ridge_omp import OMPRegressor

model = OMPRegressor(
    poly_degree=2,
    n_nonzero_coefs=3         # 非零系数数量
)
```

## 自动类型转换特性

### 输入验证和转换
- **自动形状转换**: 1维numpy数组自动转换为2维
- **类型检查**: 验证输入数据类型和形状
- **特征名称**: numpy数组输入时自动生成或使用用户指定的特征名称
- **索引对齐**: 确保特征和目标变量索引一致

### 警告信息
```python
# 输入1维数组时会显示警告
# UserWarning: 输入的特征数据是1维数组，将自动转换为2维
```

## 错误处理

### 常见错误和解决方案

1. **特征数量不匹配**
```python
# 错误: 训练时1个特征，预测时2个特征
# 解决: 确保预测数据特征数量与训练时一致
```

2. **数据长度不匹配**
```python
# 错误: X和y的样本数量不同
# 解决: 检查X和y的第一维长度是否相等
```

3. **空数据**
```python
# 错误: 输入空数组或DataFrame
# 解决: 确保输入数据非空
```

## 最佳实践

### 1. 特征命名
```python
# 为numpy数组指定有意义的特征名称
model.fit(X_array, y_array, feature_names=['temperature', 'pressure'])
```

### 2. 数据类型一致性
```python
# 保持训练和预测时的数据类型一致
# 或者让库自动处理类型转换
```

### 3. 性能考虑
```python
# 对于大型数据集，pandas DataFrame可能提供更好的性能
# 对于简单数值计算，numpy数组更轻量
```

## 示例：完整工作流程

```python
import numpy as np
import pandas as pd
from sisso_py.sparse_regression.sisso import SISSORegressor

# 生成示例数据
X = np.random.randn(1000, 3)  # 3个特征
y = X[:, 0]**2 + 2*X[:, 1] + np.random.randn(1000)*0.1

# 方法1: 直接使用numpy数组
model1 = SISSORegressor(K=2)
model1.fit(X, y, feature_names=['f1', 'f2', 'f3'])

# 方法2: 转换为pandas并使用
X_df = pd.DataFrame(X, columns=['feature_1', 'feature_2', 'feature_3'])
y_series = pd.Series(y, name='target')

model2 = SISSORegressor(K=2)
model2.fit(X_df, y_series)

# 两种方法都能工作，选择最适合你工作流程的方式
```

这种灵活的输入格式支持让SISSO计算库更容易集成到现有的数据科学工作流程中。
